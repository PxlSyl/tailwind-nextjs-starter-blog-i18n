---
title: Nouvelles fonctionnalit√©s dans la V.1
series:
  order: 2
  title: "Blog Starter"
date: '2021-08-07'
lastmod: '2021-02-01'
language: fr
tags: ['next-js', 'tailwind', 'guide']
authors: ['tailsazimuth']
draft: false
summary: Un aper√ßu des nouvelles fonctionnalit√©s publi√©es dans la v1 - copie de bloc de code, auteurs multiples, mise en page via frontmatter, etc.
bibliography: references-data.bib
---

## Vue d'ensemble

Un article sur les nouvelles fonctionnalit√©s introduites dans la v1.0. Nouvelles fonctionnalit√©s:

<TOCInline toc={props.toc} exclude="Overview" toHeading={2} />

Le premier chargement de JS est pass√© de 43 Ko √† 39 Ko malgr√© toutes les nouvelles fonctionnalit√©s ajout√©es ! [^1]

[^1]: Avec les nouvelles modifications apport√©es √† Nextjs 12, le premier chargement de JS passe √† 45 Ko.

Consultez le [guide de mise √† niveau](#upgrade-guide) ci-dessous si vous migrez √† partir de la version v0 du mod√®le.

## Couleurs du th√®me

Vous pouvez facilement modifier la couleur du th√®me en modifiant l'attribut principal dans le fichier de configuration tailwind:

```js:tailwind.config.js
theme: {
    colors: {
      primary: colors.teal,
      gray: colors.neutral,
      ...
    }
  ...
}
```

L'attribut de couleur primaire doit se voir attribuer un objet avec des cl√©s de 50, 100, 200 ... 900 et les valeurs de code couleur correspondantes.

Tailwind comprend d'excellentes palettes de couleurs par d√©faut qui peuvent √™tre utilis√©es pour cr√©er un th√®me pour votre propre site Web. Consultez la [page de documentation sur la personnalisation des couleurs](https://tailwindcss.com/docs/customizing-colors) pour conna√Ætre la gamme compl√®te d'options.

Vous migrez depuis la v1? Vous pouvez revenir au th√®me pr√©c√©dent en d√©finissant ¬´primary¬ª sur ¬´colors.sky¬ª (Tailwind 2.2.2 et sup√©rieur, sinon ¬´colors.lightBlue¬ª) et en changeant le gris en ¬´colors.gray¬ª.

Depuis la v1.1.2+, vous pouvez √©galement personnaliser facilement le style de vos blocs de code en modifiant la feuille de style `css/prism.css`. Les noms de classes de jetons sont compatibles avec prismjs
afin que vous puissiez copier et adapter les styles de jetons √† partir d'une feuille de style prismjs, par exemple. [th√®mes prisme](https://github.com/PrismJS/prism-themes).

## Compilateur Xdm MDX

Nous avons bascul√© le bundler MDX de [next-mdx-remote](https://github.com/hashicorp/next-mdx-remote) vers [mdx-bundler](https://github.com/kentcdodds/mdx-bundler ).
Cela utilise [xdm](https://github.com/wooorm/xdm) sous le capot, les derni√®res biblioth√®ques Micromark 3 et Remark, Rehype.

**Avertissement¬†:** Si vous utilisiez des biblioth√®ques de remark ou de rehype personnalis√©es, veuillez effectuer une mise √† niveau vers celles compatibles Micromark 3. Si vous effectuez une mise √† niveau, veuillez supprimer `node_modules` et `package-lock.json` pour √©viter d'avoir des probl√®mes li√©s aux d√©pendances pass√©es.

[xdm](https://github.com/wooorm/xdm) contient plusieurs am√©liorations par rapport √† [@mdx-js/mdx](https://github.com/mdx-js/mdx), le compilateur utilis√© en interne par next -mdx-remote, mais il peut y avoir des changements de comportement importants.
Veuillez v√©rifier votre sortie markdown pour v√©rifier.

Certaines nouvelles possibilit√©s incluent le chargement de composants directement dans le fichier mdx en utilisant la syntaxe d'importation et l'inclusion de code js qui pourrait √™tre compil√© et regroup√© lors de l'√©tape de construction.

Par exemple, l'extrait jsx suivant peut √™tre utilis√© directement dans un fichier MDX pour afficher le composant de titre de page:

```jsx
// Or import PageTitle from './components/PageTitle.js' if you are using js
import PageTitle from './components/PageTitle.tsx'
;<PageTitle> Using JSX components in MDX </PageTitle>
```

La configuration par d√©faut r√©sout tous les composants relatifs au r√©pertoire `components`.

**Note**:
Les composants qui n√©cessitent des chargeurs d'images externes n√©cessitent √©galement une configuration esbuild suppl√©mentaire.
Les composants qui d√©pendent de l'√©tat global de l'application sur le cycle de vie, comme le composant Nextjs `Link`, ne fonctionneraient pas non plus avec cette configuration car chaque fichier mdx est construit ind√©pendamment.
Dans de tels cas, il est pr√©f√©rable d'utiliser la substitution de composants.

## Composant table des mati√®res

Inspir√© par [Docusaurus](https://docusaurus.io/docs/next/markdown-features/inline-toc) et la [gatsby-remark-table-of-contents](https://www.gatsbyjs.com/ plugins/gatsby-remark-table-of-contents/),
la variable `toc` contenant tous les en-t√™tes de niveau sup√©rieur du document est transmise au fichier MDX et peut √™tre stylis√©e en cons√©quence.
Pour simplifier la g√©n√©ration d'une table des mati√®res (TOC), vous pouvez utiliser le composant `TOCInline` existant.

Par exemple, la table des mati√®res de cet article a √©t√© g√©n√©r√©e avec le code suivant:

```jsx
<TOCInline toc={props.toc} exclude="Overview" toHeading={2} />
```

Vous pouvez personnaliser les titres affich√©s en configurant les accessoires ¬´ fromHeading ¬ª et ¬´ toHeading ¬ª, ou exclure des titres particuliers.
en passant une cha√Æne ou un tableau de cha√Ænes √† la prop `exclude`. Par d√©faut, tous les titres de profondeur 3 ou inf√©rieure sont en retrait. Cela peut √™tre configur√© en modifiant la propri√©t√© ¬´ indentDepth ¬ª.
Un accessoire `asDisclosure` peut √™tre utilis√© pour restituer la table des mati√®res dans un √©l√©ment de divulgation extensible.

Voici la table des mati√®res compl√®te rendue dans un √©l√©ment de divulgation.

```jsx
<TOCInline toc={props.toc} asDisclosure />
```

<TOCInline toc={props.toc} asDisclosure />

## Layouts

Vous pouvez mapper le contenu du blog mdx aux composants de mise en page en configurant le champ frontmatter. Par exemple, cet article est √©crit avec la nouvelle mise en page ¬´ PostSimple ¬ª !

### Ajouter de nouveaux mod√®les

Les mod√®les de mise en page sont stock√©s dans le dossier `./layouts`. Vous pouvez ajouter vos composants React que vous souhaitez mapper au contenu markdown dans ce dossier.
Le nom du fichier de composant doit correspondre √† celui sp√©cifi√© dans le champ ¬´layout¬ª du frontmatter markdown.

Le seul champ obligatoire est ¬´enfants¬ª qui contient le contenu MDX rendu, bien que vous souhaitiez probablement transmettre le contenu de frontMatter et le restituer dans le mod√®le.

Vous pouvez configurer le mod√®le pour qu'il prenne en compte d'autres champs - voir le composant `PostLayout` pour un exemple.

Voici un exemple de mise en page que vous pouvez personnaliser davantage:

```jsx
export default function ExampleLayout({ frontMatter, children }) {
  const { date, title } = frontMatter

  return (
    <SectionContainer>
      <div>{date}</div>
      <h1>{title}</h1>
      <div>{children}</div>
    </SectionContainer>
  )
}
```

### Configuration d'un article de blog frontmatter

Utilisez le champ frontmatter `layout` pour sp√©cifier le mod√®le auquel vous souhaitez mapper la publication markdown. Voici √† quoi ressemble le contenu de cet article:

```
---
title: 'Nouvelles fonctionnalit√©s dans la V.1'
date: '2021-05-26   '
tags: ['next-js', 'tailwind', 'guide']
draft: false
summary: 'Pr√©sentation des nouvelles fonctionnalit√©s du mod√®le de mise en page - vous pouvez mapper le contenu du blog mdx aux composants de mise en page en configurant le champ frontmatter'
layout: PostSimple
---
```

Vous pouvez configurer la mise en page par d√©faut dans la section de page respective en modifiant la variable `DEFAULT_LAYOUT`.
La page `DEFAULT_LAYOUT` pour les articles de blog est d√©finie sur `PostLayout`.

### Etendre

`layout` est mapp√© au wrapper qui enveloppe l'int√©gralit√© du contenu MDX.

```jsx
export const MDXComponents = {
  Image,
  a: CustomLink,
  pre: Pre,
  wrapper: ({ components, layout, ...rest }) => {
    const Layout = require(`../layouts/${layout}`).default
    return <Layout {...rest} />
  },
}

export const MDXLayoutRenderer = ({ layout, mdxSource, ...rest }) => {
  const MDXLayout = useMemo(() => getMDXComponent(mdxSource), [mdxSource])

  return <MDXLayout layout={layout} components={MDXComponents} {...rest} />
}
```

Utilisez le composant `MDXLayoutRenderer` sur une page sur laquelle vous souhaitez accepter un nom de mise en page √† mapper √† la mise en page souhait√©e.
Vous devez transmettre le nom de la mise en page du dossier de mise en page (il doit correspondre exactement).

## Analytique

Le mod√®le prend d√©sormais en charge [plausible](https://plausible.io/), [simple Analytics](https://simpleanalytics.com/) et Google Analytics.
Configurez ¬´ siteMetadata.js ¬ª avec les param√®tres qui correspondent au fournisseur d'analyse souhait√©.

```js
analytics: {
    // supports plausible, simpleAnalytics or googleAnalytics
    plausibleDataDomain: '', // e.g. tailwind-nextjs-starter-blog.vercel.app
    simpleAnalytics: false, // true or false
    googleAnalyticsId: '', // e.g. UA-000000-2 or G-XXXXXXX
  },
```

Les √©v√©nements personnalis√©s sont √©galement pris en charge. Vous pouvez importer la fonction `logEvent` √† partir du fichier `@components/analytics/[ANALYTICS-PROVIDER]` et l'appeler lorsque
d√©clenchant certains √©v√©nements int√©ressants. _Remarque_: Une configuration suppl√©mentaire peut √™tre requise en fonction du fournisseur d'analyses, veuillez consulter leur site officiel
documentation pour plus d'informations.

## Syst√®me de commentaires du blog

Nous avons √©galement ajout√© la prise en charge de [giscus](https://github.com/laymonage/giscus), [utterances](https://github.com/utterance/utterances) ou disqus.
Pour l'activer, configurez simplement la propri√©t√© de commentaires ¬´ siteMetadata.js ¬ª avec le fournisseur et les param√®tres souhait√©s tels que sp√©cifi√©s dans le fichier de configuration.

```js
comment: {
    // Select a provider and use the environment variables associated to it
    // https://vercel.com/docs/environment-variables
    provider: 'giscus', // supported providers: giscus, utterances, disqus
    giscusConfig: {
      // Visit the link below, and follow the steps in the 'configuration' section
      // https://giscus.app/
      repo: process.env.NEXT_PUBLIC_GISCUS_REPO,
      repositoryId: process.env.NEXT_PUBLIC_GISCUS_REPOSITORY_ID,
      category: process.env.NEXT_PUBLIC_GISCUS_CATEGORY,
      categoryId: process.env.NEXT_PUBLIC_GISCUS_CATEGORY_ID,
      mapping: 'pathname', // supported options: pathname, url, title
      reactions: '1', // Emoji reactions: 1 = enable / 0 = disable
      // Send discussion metadata periodically to the parent window: 1 = enable / 0 = disable
      metadata: '0',
      // theme example: light, dark, dark_dimmed, dark_high_contrast
      // transparent_dark, preferred_color_scheme, custom
      theme: 'light',
      // theme when dark mode
      darkTheme: 'transparent_dark',
      // If the theme option above is set to 'custom`
      // please provide a link below to your custom theme css file.
      // example: https://giscus.app/themes/custom_example.css
      themeURL: '',
    },
    utterancesConfig: {
      // Visit the link below, and follow the steps in the 'configuration' section
      // https://utteranc.es/
      repo: process.env.NEXT_PUBLIC_UTTERANCES_REPO,
      issueTerm: '', // supported options: pathname, url, title
      label: '', // label (optional): Comment üí¨
      // theme example: github-light, github-dark, preferred-color-scheme
      // github-dark-orange, icy-dark, dark-blue, photon-dark, boxy-light
      theme: '',
      // theme when dark mode
      darkTheme: '',
    },
    disqus: {
      // https://help.disqus.com/en/articles/1717111-what-s-a-shortname
      shortname: process.env.NEXT_PUBLIC_DISQUS_SHORTNAME,
    },
  },
```

## Auteurs multiples

Les informations sur les auteurs sont d√©sormais s√©par√©es de ¬´ siteMetadata.js ¬ª et stock√©es dans son propre dossier ¬´ data/authors ¬ª en tant que fichier markdown. Au minimum, vous aurez besoin d'un fichier ¬´ default.md ¬ª avec les informations de paternit√©. Vous pouvez cr√©er des fichiers suppl√©mentaires selon vos besoins et le nom du fichier sera utilis√© comme r√©f√©rence √† l'auteur.

Voici √† quoi pourrait ressembler un fichier markdown d'auteur¬†:

```md:default.md
---
name: Tails Azimuth
avatar: /static/images/avatar.png
occupation: Professeur de sciences atmosph√©riques
company: Universit√© de Stanford
email: address@yoursite.com
twitter: https://twitter.com/Twitter
linkedin: https://www.linkedin.com
github: https://github.com
---

Longue description de vous...
```

Vous pouvez utiliser ces informations √† plusieurs endroits du mod√®le. Par exemple, dans la section √† propos de la page, nous r√©cup√©rons les informations par d√©faut sur l'auteur avec cette ligne de code:

```js
const authorDetails = await getFileBySlug('authors', ['default'])
```

Ceci est rendu dans le mod√®le `AuthorLayout`.

### Plusieurs auteurs dans le billet de blog

Le texte d'un article de blog accepte un champ de tableau ¬´auteurs¬ª facultatif. Si aucun champ n'est sp√©cifi√©, on suppose que l'auteur par d√©faut est utilis√©. Transmettez simplement un tableau d'auteurs pour afficher plusieurs auteurs associ√©s √† une publication.

Par exemple, le texte suivant affichera les auteurs donn√©s par `data/authors/default.md` et `data/authors/sparrowhawk.md`

```yaml
title: 'My first post'
date: '2021-01-12'
draft: false
summary: 'My first post'
authors: ['default', 'sparrowhawk']
```

Une d√©mo d'un article de plusieurs auteurs est pr√©sent√©e dans [Introducing Tailwind Nextjs Starter Blog post](/blog/introducing-tailwind-nextjs-starter-blog).

## Bouton Copier pour les blocs de code

Passez la souris sur un bloc de code et vous remarquerez un bouton de copie inspir√© de GitHub¬†! Vous pouvez modifier `./components/Pre.js` pour le personnaliser davantage.
Le composant est pass√© √† `MDXComponents` et modifie tous les blocs `<pre>`.

## Mise en surbrillance des lignes et num√©ros de ligne

La mise en √©vidence des lignes et les num√©ros de ligne sont d√©sormais pris en charge d√®s le d√©part gr√¢ce au nouveau [plug-in rehype-prism-plus](https://github.com/timlrx/rehype-prism-plus)

Le bloc de code javascript suivant:

````
```js {1, 3-4} showLineNumbers
var num1, num2, sum
num1 = prompt('Enter first number')
num2 = prompt('Enter second number')
sum = parseInt(num1) + parseInt(num2) // "+" means "add"
alert('Sum = ' + sum) // "+" means combine into a string
```
````

apparaitra comme ceci

```js {1,3-4} showLineNumbers
var num1, num2, sum
num1 = prompt('Enter first number')
num2 = prompt('Enter second number')
sum = parseInt(num1) + parseInt(num2) // "+" means "add"
alert('Sum = ' + sum) // "+" means combine into a string
```

Pour modifier les styles, changez les s√©lecteurs de classe suivants dans le fichier `prism.css`¬†:

```css
.code-highlight {
  @apply float-left min-w-full;
}

.code-line {
  @apply -mx-4 block border-l-4 border-opacity-0 pl-4 pr-4;
}

.code-line.inserted {
  @apply bg-green-500 bg-opacity-20;
}

.code-line.deleted {
  @apply bg-red-500 bg-opacity-20;
}

.highlight-line {
  @apply -mx-4 border-l-4 border-primary-500 bg-gray-700 bg-opacity-50;
}

.line-number::before {
  @apply -ml-2 mr-4 inline-block w-4 text-right text-gray-400;
  content: attr(line);
}
```

## Composant Newsletter (v1.1.3)

Introduit dans la v1.1.3, le composant newsletter vous offre un moyen simple de cr√©er une audience. Il s'int√®gre aux fournisseurs suivants:

- [Mailchimp](https://mailchimp.com/)
- [Buttondown](https://buttondown.email/)
- [Convertkit](https://convertkit.com/)

Pour l'utiliser, sp√©cifiez le fournisseur que vous utilisez dans le fichier de configuration et ajoutez les variables d'environnement n√©cessaires au fichier `.env`.
Pour plus d'informations sur les variables requises, consultez `.env.sample.`

Deux composants sont export√©s, un composant `NewsletterForm` par d√©faut et un composant `BlogNewsletterForm`, qui est √©galement transmis en tant que composant MDX.
et peut √™tre utilis√© dans un article de blog:

```jsx
<BlogNewsletterForm title="Like what you are reading?" />
```

<BlogNewsletterForm title="Like what you are reading?" />

Le composant s'appuie sur les [routes API] de nextjs (https://nextjs.org/docs/api-routes/introduction) qui n√©cessitent la configuration d'une instance c√¥t√© serveur de nextjs.
et n'est pas compatible avec un export de site 100% statique. Les utilisateurs doivent soit s'auto-h√©berger, soit utiliser une plate-forme compatible comme Vercel ou Netlify qui prend en charge cette fonctionnalit√©.

Une alternative compatible avec les sites statiques consiste √† remplacer l'itin√©raire dans le composant de newsletter par un fournisseur de point de terminaison d'API de formulaire.

## Bibliographie et citations (v1.2.1)

Le plugin `rehype-citation` est ajout√© au pipeline de traitement xdm dans la v1.2.1. Cela vous permet de formater facilement des citations et d'ins√©rer une bibliographie √† partir d'un fichier bibtex ou CSL-json existant.

Par exemple, l'exemple de code remark suivant:

```md
Standard citation [@Nash1950]
In-text citations e.g. @Nash1951
Multiple citations [see @Nash1950; @Nash1951, page 50]

**References:**

[^ref]
```

sera rendu ainsi:

Standard citation [@Nash1950]  
In-text citations e.g. @Nash1951  
Multiple citations [see @Nash1950; @Nash1951, page 50]

**References:**

[^ref]

Une bibliographie sera ins√©r√©e √† la fin du document, mais elle peut √™tre √©cras√©e en sp√©cifiant une balise `[^Ref]` √† l'emplacement pr√©vu.
Le plugin utilise la formation de citations APA, mais prend √©galement en charge les CSL suivants, ¬´ apa ¬ª, ¬´ vancouver ¬ª, ¬´ harvard1 ¬ª, ¬´ chicago ¬ª, ¬´ mla ¬ª, ou un chemin vers un fichier CSL sp√©cifi√© par l'utilisateur.

Voir [rehype-citation readme](https://github.com/timlrx/rehype-citation) pour plus d'informations sur les options de configuration.

## Police d'√©criture auto-h√©berg√©e (v1.5.0)

La police Google a √©t√© remplac√©e par la police auto-h√©berg√©e de [Fontsource](https://fontsource.org/). Cela donne les [avantages](https://fontsource.org/docs/introduction) suivants:

> L'auto-h√©bergement apporte des gains de performances significatifs, car le chargement de polices √† partir de services h√©berg√©s, tels que Google Fonts, entra√Æne une requ√™te r√©seau suppl√©mentaire (bloquant le rendu). Pour donner une perspective, pour les sites Web simples, il a √©t√© constat√© que les temps de chargement visuels √©taient doubl√©s.
>
> Les polices restent verrouill√©es en version. Google propose souvent des mises √† jour de ses polices sans pr√©avis, ce qui peut interf√©rer avec vos projets de production en direct. G√©rez vos polices comme n'importe quelle autre d√©pendance NPM.
>
> S'engager √† respecter la confidentialit√©. Google suit l'utilisation de leurs polices et pour ceux qui sont extr√™mement pr√©occup√©s par la confidentialit√©, l'auto-h√©bergement est une alternative.

Cela conduit √† un ensemble de polices plus petit et √† un temps de chargement plus rapide de 0,1 seconde ([comparaison webpagetest](https://www.webpagetest.org/video/compare.php?tests=220201_AiDcFH_f68a69b758454dd52d8e67493fdef7da,220201_BiDcMC_bf2d53f14483814ba61e794 311dfa771)).

Pour modifier la police Inter par d√©faut:

1. Installez la [police](https://fontsource.org/fonts) pr√©f√©r√©e - `npm install -save @fontsource/<font-name>`
2. Mettez √† jour l'importation dans `pages/_app.js`- `import '@fontsource/<font-name>.css'`
3. Mettez √† jour la propri√©t√© `fontfamily` dans le fichier de configuration CSS tailwind

## Guide de mise √† niveau

Des parties importantes du code ont √©t√© modifi√©es de la v0 √† la v1, notamment la prise en charge des mises en page et un nouveau moteur mdx.

Il n'y a pas non plus de r√©elle raison de changer si le pr√©c√©dent r√©pond √† vos besoins et il pourrait √™tre plus facile de le copier.
le composant change qui vous int√©resse sur votre blog existant plut√¥t que de tout migrer.

N√©anmoins, si vous souhaitez le faire et que vous n'avez pas beaucoup modifi√© le mod√®le, vous pouvez cloner la nouvelle version et copier l'article de blog vers le nouveau mod√®le.

Une autre alternative serait d'extraire la derni√®re version du mod√®le avec le code suivant:

```bash
git remote add template git@github.com:timlrx/tailwind-nextjs-starter-blog.git
git pull template v1 --allow-unrelated-histories
rm -rf node_modules
```

Vous pouvez voir un exemple d'une telle migration dans ce [commit](https://github.com/timlrx/timlrx.com/commit/bba1c185384fd6d5cdaac15abf802fdcff027286) pour mon blog personnel.

La v1 utilise √©galement `feed.xml` plut√¥t que `index.xml`, pour √©viter certains probl√®mes de construction avec Vercel. Si vous migrez, vous devez ajouter une redirection vers ¬´ next.config.js ¬ª comme ceci:

```js
async redirects() {
  return [
    {
      source: '/:path/index.xml',
      destination: '/:path/feed.xml',
      permanent: true,
    }
  ]
}
```
